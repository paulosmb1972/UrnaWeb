<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UrnaWeb Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        *{box-sizing:border-box}
        body{margin:0;font-family:Arial,sans-serif;background:#0a2a66;color:white;display:flex;justify-content:center}
        .screen{display:none;padding:20px;width:100%;max-width:500px;min-height:100vh}
        .active{display:block}
        h2,h3{text-align:center;color:#1abc9c}
        input,button{width:100%;padding:15px;margin:10px 0;border-radius:8px;border:none;font-size:16px}
        button{background:#1abc9c;color:white;font-weight:bold;cursor:pointer}
        .secondary{background:#f1c40f;color:#333}
        .lang-box{position:fixed;top:10px;right:10px;z-index:100}
        .lang-box button{width:auto;padding:5px 10px;background:rgba(255,255,255,0.2);margin-left:5px;color:white;border:1px solid white}
        .result-box{background:white;color:black;padding:20px;border-radius:10px}
    </style>
</head>
<body>

<div class="lang-box">
  <button onclick="setLang('pt')">游游</button>
  <button onclick="setLang('en')">游쥟릖</button>
  <button onclick="setLang('es')">游쀯릖</button>
</div>

<div id="login" class="screen active">
    <h2 id="tLogin">Entrar no UrnaWeb</h2>
    <input id="userEmail" type="email" placeholder="Seu e-mail">
    <button onclick="enviarCodigo()" id="btnSendCode">Enviar C칩digo</button>
</div>

<div id="verify" class="screen">
    <h2 id="tVerify">Validar C칩digo</h2>
    <input id="inputCode" type="text" placeholder="000000" style="text-align:center;letter-spacing:5px">
    <button onclick="validarCodigo()" class="secondary" id="btnVerify">Entrar</button>
</div>

<div id="setup" class="screen">
    <h2 id="tConfig">Configura칞칚o</h2>
    <input id="electionName" placeholder="Nome da Elei칞칚o">
    <button onclick="showScreen('results')" class="secondary" id="btnSkip">Pular para Resultado</button>
</div>

<div id="results" class="screen">
    <h2 id="tResult">Resultados</h2>
    <div id="resultContent" class="result-box">
        <p id="pRes">Simula칞칚o de Resultado Conclu칤da.</p>
    </div>
    <button onclick="exportPDF()" id="btnPDF">Gerar PDF</button>
</div>

<script>
// --- CONFIGURA칂츾O ATUALIZADA ---
const PUBLIC_KEY = "_PKL4Oj92o48KurSF"; 
const SERVICE_ID = "service_oqfbzrm";
const TEMPLATE_ID = "template_t3aio8f";

emailjs.init(PUBLIC_KEY);

let codigoGerado = "";
let emailUsuario = "";
let lang = "pt";

// --- DICION츼RIO COMPLETO ---
const i18n = {
  pt: { tLogin: "Entrar no UrnaWeb", btnSendCode: "Enviar C칩digo", userEmail: "Seu e-mail", tVerify: "Validar C칩digo", btnVerify: "Entrar", tConfig: "Configura칞칚o", electionName: "Nome da Elei칞칚o", tResult: "Resultados", btnSkip: "Pular para Resultado", pRes: "Simula칞칚o Conclu칤da.", btnPDF: "Gerar PDF" },
  en: { tLogin: "Login to UrnaWeb", btnSendCode: "Send Code", userEmail: "Your email", tVerify: "Verify Code", btnVerify: "Enter", tConfig: "Setup", electionName: "Election Name", tResult: "Results", btnSkip: "Skip to Results", pRes: "Simulation Finished.", btnPDF: "Get PDF" },
  es: { tLogin: "Entrar en UrnaWeb", btnSendCode: "Enviar C칩digo", userEmail: "Tu correo", tVerify: "Validar C칩digo", btnVerify: "Entrar", tConfig: "Configuraci칩n", electionName: "Nombre Elecci칩n", tResult: "Resultados", btnSkip: "Saltar a Resultados", pRes: "Simulaci칩n Finalizada.", btnPDF: "Generar PDF" }
};

// --- FUN칂츾O DE IDIOMA (CORRIGIDA) ---
function setLang(l) {
    lang = l;
    const t = i18n[l];
    Object.keys(t).forEach(id => {
        const el = document.getElementById(id);
        if (el) {
            // Se for INPUT, traduz o placeholder. Se for TEXTO, traduz o innerText.
            if (el.tagName === "INPUT") el.placeholder = t[id];
            else el.innerText = t[id];
        }
    });
}

function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

// --- ENVIO DE C칍DIGO ---
function enviarCodigo() {
    emailUsuario = document.getElementById("userEmail").value;
    if(!emailUsuario.includes("@")) return alert("E-mail inv치lido");

    codigoGerado = Math.floor(100000 + Math.random() * 900000).toString();
    console.log("DEBUG: C칩digo gerado ->", codigoGerado);

    const params = {
        to_email: emailUsuario,
        validation_code: codigoGerado 
    };

    emailjs.send(SERVICE_ID, TEMPLATE_ID, params)
    .then(() => {
        alert("C칩digo enviado para: " + emailUsuario);
        showScreen('verify');
    })
    .catch(err => {
        console.error("Erro EmailJS:", err);
        alert("Erro EmailJS: " + err.status + " - " + err.text);
    });
}

function validarCodigo() {
    const inputCode = document.getElementById("inputCode").value;
    if(inputCode === codigoGerado && codigoGerado !== "") {
        showScreen('setup');
    } else {
        alert("C칩digo incorreto!");
    }
}

function exportPDF() {
    const content = document.getElementById("resultContent");
    html2pdf().from(content).save("resultado-urna.pdf");
}
</script>
</body>
</html>
